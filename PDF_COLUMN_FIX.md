# PDF Extraction - Multi-Column Fix (Stream Order)

## ðŸŽ¯ The Problem
The previous extraction method used **Strict Geometric Sorting** (Top-to-Bottom, Left-to-Right).
While this works for single-column text, it fails for **Multi-Column Resumes**.

### Example Scenario
A resume has two side-by-side columns:
- Left: Education (Dates, Schools)
- Right: Work Experience (Dates, Companies)

**With Geometric Sorting:**
The parser reads line-by-line across the page:
1. `EDUCATION` (left) ... `WORK EXPERIENCE` (right)
2. `2020-2024` (left) ... `2019-Present` (right)
3. `University A` (left) ... `Company B` (right)

**Result:**
The text becomes interleaved: `EDUCATION WORK EXPERIENCE 2020-2024 2019-Present...`
The regex parser sees "EDUCATION" instantly followed by "WORK EXPERIENCE", assumes the Education section is empty, and fails to extract anything.

---

## âœ… The Solution: Stream Order + Reverse Jump Detection

Unique approach tailored for Resume PDFs (often generated by Canva/builders):

### 1. **Stream Order Extraction**
Instead of sorting coordinates, we read text items in the order they appear in the PDF file stream.
- Most PDF generators write text **Block-by-Block**.
- Example Order: Header Block â†’ Left Column Block â†’ Right Column Block.
- This preserves the logical flow: `EDUCATION... University A... WORK EXPERIENCE... Company B...`

### 2. **Reverse Jump Detection**
We detect when the text cursor "jumps back up" the page vertically.
- If `currentY > lastY + 100`, it means we moved from the bottom of one column to the top of the next.
- We insert `\n\n` to ensure distinct separation between these blocks.

### 3. **Smart Horizontal Spacing**
- If items are on the same line but far apart (`> 50px`), we add double spaces.
- Ensures table-like headers (e.g., "Role                 Date") don't merge into "RoleDate".

---

## ðŸ” Code Changes

```typescript
// Removed textItems.sort(...)

// Reverse Jump Check
if (currentY > lastY + 100) {
    pageText += '\n\n'; // Moved back up -> New Column/Block
}
// Normal Line Break
else if (lastY - currentY > 5) {
    pageText += '\n';   // Moved down -> New Line
}
```

## ðŸ“Š Expected Impact

**Before:**
- "Education" merged with "Work Experience"
- Parsing failed for most sections
- Only "Name" extracted (because header is usually top-block)

**After:**
- "Education" text block is contiguous
- "Work Experience" text block is contiguous
- Regex parsers can correctly identify start/end of sections
- Full content extraction including side-by-side columns

This is the standard robust way to handle "Canva-style" graphical resumes.
